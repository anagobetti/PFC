\chapter{Resultados}

Para a execução do projeto, algumas etapas de desenvolvimento tiveram de ser seguidas: familiarização com a biblioteca, estudo dos módulos envolvidos, leitura dos requisitos, elaboração de documento descrevendo todo o processo de implementação e relacionamento com os diversos módulos, implementação e testes. Neste capitulo serão apresentados os resultados de cada operação realizada no processamento  de imagem, que foi detalhado no capitulo anterior. 

\section{Leitura automática de documentos}

\subsection{Calibração automática do sistema}

Como foi descrito no capítulo anterior, converte-se a imagem para o domínio de escala de cinza, é feito um redimensionamento da mesma e esta será a imagem utilizada como base para todo o sistema de leitura automática. 
Para segmentação da imagem, um dado importante é a análise do histograma da imagem gerada. O histograma é uma função que descreve a frequência com que cada nível de cinza aparece na imagem. Ela é utilizada para ver a distribuição de nível de cinza, permitindo que a imagem seja normalizada, excluindo algumas regiões que não são as regiões de interesse pois estão fora da faixa de cinza desejada, eliminando ruídos e principalmente deixando que o sistema fique menos vulnerável a diferentes configurações de scanners que podem gerar imagens com diferentes ajustes de contraste e brilho. 

Na figura \ref{fig:HistogramaCNHfINAL}, pode ser visto o histograma da imagem original e o histograma da imagem normalizada. 

\begin{figure}[h]
	\centering
		\includegraphics[width=1.00\textwidth]{../../Capitulo4/HistogramaCNHfINAL.png}
		\caption{a) Histograma da imagem do documento após a conversão para escala de cinza e b) Histograma após a seleção da faixa cinza de interesse}
	\label{fig:HistogramaCNHfINAL}
\end{figure}

\clearpage

Como pode ser visto, antes da binarização da imagem existia um pequeno pico no valor próximo ao 90 e uma irregularidade após o 240, porém o grande pico era próximo ao 220, após a normalização do histograma pode-se perceber que os pontos fora da faixa de interesse foram ignorados, reduzindo assim o nível de ruído da imagem.    

\begin{figure}[h]
	\centering
		\includegraphics[width=1.00\textwidth]{../../Capitulo4/CNH_EscaladeCinzaeBin.jpg}
		\caption{a) Imagem da CNH convertida em escala de cinza, sem tratamento e b) após a seleção da faixa cinza de interesse }
	\label{fig:CNH_EscaladeCinzaeBin}
\end{figure}

	
\subsection{Reconhecimento da face e linhas}

Como foi explicado no capitulo anterior, buscou-se identificar os campos de dados com base na localização das linhas e da face contida na CNH, abaixo segue a figura com as delimitações da linha em azul e a delimitação da face em vermelho. 

Após este tratamento, foi possível identificar as regiões de interesse e cada uma destas imagens delimitadas pelos retângulos vermelhos da figura \ref{fig:imagemLinhas2} passou pelo sistema de leitura de caracteres isoladamente e o resultado foi a obtenção dos dados da CNH, estes dados foram enviados para uma interface que será apresentada na próxima seção.


\begin{figure}[h]
	\centering
		\includegraphics[width=1.0\textwidth]{../../imagemLinhas2.jpg}
		\caption{Resultado do processamento após a obtenção das linhas}
	\label{fig:imagemLinhas2}
\end{figure}
\clearpage


Como um todo, o sistema se mostrou bastante eficiente e após pequenas modificações, como delimitação do conjunto de caracteres do leitor para cada campo, o sistema leu corretamente todas as CNHs testadas. Foram utilizadas 5 (cinco) CNHs do modelo antigo e 1 (uma) CNH do novo padrão. Em média o sistema demorou 7 segundos para exibir os dados na tela e este resultado é muito positivo, uma vez que o tempo para uma pessoa interpretar e digitar o documento é muito superior. 

\section{Protótipo da interface}

Com o objetivo de deixar o sistema mais flexível a mudanças e atualizações, ele foi dividido em dois módulos completamente independentes. O primeiro modulo é o de identificação e interpretação dos dados, como foi descrito na seção anterior e o segundo modulo é um protótipo do que seria a interface gráfica de utilização do sistema, para este modelo foi realizada uma interface simples somente para seleção da imagem, apresentação dos dados obtidos e arquivamento do mesmo em formato XML.

\begin{figure}[h]
	\centering
		\includegraphics[width=1.00\textwidth]{../../Capitulo4/Interface.png}
		\caption{Interface desenvolvida para o protótipo}
	\label{fig:Interface}
\end{figure}


Como foi dito no capitulo anterior, esta interface seria responsável pela seleção da imagem, para este protótipo foram escolhidas duas formas de entrada. A primeira é a seleção manual da imagem, onde o operador do sistema deve navegar até a pasta desejada e escolher a imagem. Além disto, foi implementado no sistema uma função para observar automaticamente uma pasta, que no caso é a pasta de configuração do scanner, esta pasta pode ser alterada nas configurações do sistema e ajuda a tornar o sistema ainda mais rápido, uma vez que a interferência do usuário é menor. Como monitorar uma pasta pode ser uma função não desejada, é possível desabilitar esta opção desmarcando o checkbox na interface. 

Uma vez obtida a imagem, é solicitado o tratamento e a interface fica esperando o resultado. Quando recebe o mesmo ela é exibida preenchendo o campo da imagem e os respectivos campos de texto contidos na tela. Estes campos são editáveis, para caso seja necessário realizar alguma correção. Após a conferencia dos dados é possível salvar os arquivos em formato XML, em que o nome do arquivo será  formado pelo primeiro nome da pessoa mais o CPF, apertando o botão Salvar no canto inferior direito da tela.

%todo Ana
%%[ARQUIVO XML]

Caso ocorra algum erro no tratamento da imagem, por exemplo, a face não seja identificada, invalidando o documento, o arquivo não seja uma imagem ou a imagem não possua resolução suficiente para o processamento, será exibida um alerta no canto inferior esquerdo.

\section{Leitura de diferentes modelos de CNH}

Como foi explicado na seção 2.1, atualmente existem dois modelos de CNH e embora a posição dos campos obedeçam a mesma ordem, a tonalidade dos dois documentos é muito diferente. Apesar disto, o tratamento inicial, em que é realizado o distribuição de cores para filtrar a imagem se mostrou bastante eficiente, sendo possível identificar corretamente os dados dos dois modelos de CNH, como pode ser visto na figura \ref{fig:InterfaceJoao}. 


\begin{figure}[ht]
	\centering
		\includegraphics[width=1.00\textwidth]{../../Interface Joao.png}
		\caption{Resultados obtidos para o novo modelo de CNH}
	\label{fig:InterfaceJoao}
\end{figure}

\clearpage